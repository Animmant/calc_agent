# PDF –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –≤ Calculator Agent

## –û–≥–ª—è–¥

Calculator Agent —Ç–µ–ø–µ—Ä –ø—ñ–¥—Ç—Ä–∏–º—É—î –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é PDF –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–≤—ñ—Ç—ñ–≤ –¥–µ–±–∞–≥—É —Ç–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏—Ö –∑–æ—à–∏—Ç—ñ–≤. –°–∏—Å—Ç–µ–º–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î [Typst](https://typst.app/) - —Å—É—á–∞—Å–Ω—É –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É LaTeX –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–∏—Å–æ–∫–æ—è–∫—ñ—Å–Ω–∏—Ö PDF –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤.

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Typst

### Windows
```bash
winget install --id Typst.Typst
```

### macOS
```bash
brew install typst
```

### Linux
```bash
cargo install --git https://github.com/typst/typst --locked typst-cli
```

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è
```bash
typst --version
```

## –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å

### 1. PDF –ó–≤—ñ—Ç–∏ –î–µ–±–∞–≥—É

–°—Ç–≤–æ—Ä—é—é—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ñ –∑–≤—ñ—Ç–∏ –ø—Ä–æ —Ä–æ–±–æ—Ç—É –∞–≥–µ–Ω—Ç–∞, –≤–∫–ª—é—á–∞—é—á–∏:
- –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- –ö—Ä–æ–∫–∏ –º—ñ—Ä–∫—É–≤–∞–Ω–Ω—è LLM
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ç–∞ —ó—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
- –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ä–æ–±–æ—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤
- –§—ñ–Ω–∞–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∞–≥–µ–Ω—Ç–∞

#### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –∞–≥–µ–Ω—Ç–∞:
```
üë§ –í–∏: –°—Ç–≤–æ—Ä–∏ –∑–≤—ñ—Ç –¥–µ–±–∞–≥—É –¥–ª—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è
ü§ñ –ê–≥–µ–Ω—Ç: [–≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î create_debug_report tool]
```

#### –ü—Ä–æ–≥—Ä–∞–º–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
```python
from src.reporting.pdf_generator import generate_debug_pdf

debug_data = {
    "original_user_query": "–°–∫—ñ–ª—å–∫–∏ –±—É–¥–µ 2 + 2 * 3?",
    "llm_reasoning_steps": ["–ö—Ä–æ–∫ 1", "–ö—Ä–æ–∫ 2"],
    "tool_name": "calculator",
    "tool_input": {"expression": "2 + 2 * 3"},
    "tool_output": "8",
    "final_agent_response": "–†–µ–∑—É–ª—å—Ç–∞—Ç: 8",
    "resources": {"llm_model": "gemini-1.5-flash"}
}

pdf_path = generate_debug_pdf(debug_data)
```

### 2. –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –ó–æ—à–∏—Ç–∏

–°—Ç–≤–æ—Ä—é—é—Ç—å PDF –¥–æ–∫—É–º–µ–Ω—Ç–∏ –∑ —Ä–æ–∑–≤'—è–∑–∫–∞–º–∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏—Ö –∑–∞–¥–∞—á —É —Å—Ç–∏–ª—ñ –∑–æ—à–∏—Ç–∞:
- –§–æ—Ä–º—É–ª—é–≤–∞–Ω–Ω—è –∑–∞–¥–∞—á—ñ
- –ü–æ–∫—Ä–æ–∫–æ–≤–µ —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è (–∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é LaTeX)
- –§—ñ–Ω–∞–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å

#### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –∞–≥–µ–Ω—Ç–∞:
```
üë§ –í–∏: –°—Ç–≤–æ—Ä–∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏–π –∑–æ—à–∏—Ç –¥–ª—è –∑–∞–¥–∞—á—ñ –ø—Ä–æ –ø–ª–æ—â—É –∫—Ä—É–≥–∞
ü§ñ –ê–≥–µ–Ω—Ç: [–≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î create_math_notebook tool]
```

#### –ü—Ä–æ–≥—Ä–∞–º–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
```python
from src.reporting.pdf_generator import generate_math_notebook_pdf

problem = "–ó–Ω–∞–π—Ç–∏ –ø–ª–æ—â—É –∫—Ä—É–≥–∞ –∑ —Ä–∞–¥—ñ—É—Å–æ–º 5 —Å–º"
solution = r"""
–î–∞–Ω–æ: r = 5 —Å–º
–§–æ—Ä–º—É–ª–∞: S = \pi r^2
S = \pi \cdot 25 = 25\pi \approx 78.54 —Å–º¬≤
"""

pdf_path = generate_math_notebook_pdf(problem, solution)
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤

```
project/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ reporting/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ pdf_generator.py
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ typst/
‚îÇ       ‚îú‚îÄ‚îÄ debug_report.typ
‚îÇ       ‚îî‚îÄ‚îÄ math_notebook.typ
‚îú‚îÄ‚îÄ output_pdfs/           # –ì–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ PDF —Ñ–∞–π–ª–∏
‚îî‚îÄ‚îÄ test_pdf_generation.py # –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
```

## –®–∞–±–ª–æ–Ω–∏ Typst

### Debug Report Template (`debug_report.typ`)
```typst
#let data = json("data.json")

= –ó–≤—ñ—Ç –î–µ–±–∞–≥—É

== –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –ó–∞–ø–∏—Ç:
#raw(data.get("original_user_query", "N/A"), block: true)

== –ö—Ä–æ–∫–∏ –ú—ñ—Ä–∫—É–≤–∞–Ω–Ω—è:
#for step in data.llm_reasoning_steps {
  - #raw(step, block: false)
}

== –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:
- –ù–∞–∑–≤–∞: #data.get("tool_name", "N/A")
- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏: #raw(json.encode(data.get("tool_input", {})), lang: "json")

== –†–µ–∑—É–ª—å—Ç–∞—Ç:
#raw(data.get("tool_output", "N/A"), block: true)
```

### Math Notebook Template (`math_notebook.typ`)
```typst
#let data = json("data.json")

= –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏–π –ó–æ—à–∏—Ç

== –£–º–æ–≤–∞ –∑–∞–¥–∞—á—ñ:
#data.get("problem_statement", "N/A")

== –†–æ–∑–≤'—è–∑–æ–∫:
#raw(data.solution_latex_body, lang: "latex")
```

## –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –ê–≥–µ–Ω—Ç–∞

### `create_debug_report`
–°—Ç–≤–æ—Ä—é—î PDF –∑–≤—ñ—Ç –¥–µ–±–∞–≥—É –∑ –¥–µ—Ç–∞–ª—å–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ —Ä–æ–±–æ—Ç—É –∞–≥–µ–Ω—Ç–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
- `original_query`: –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `reasoning_steps`: –°–ø–∏—Å–æ–∫ –∫—Ä–æ–∫—ñ–≤ –º—ñ—Ä–∫—É–≤–∞–Ω–Ω—è
- `tool_name`: –ù–∞–∑–≤–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ–≥–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `tool_input`: –í—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `tool_output`: –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–æ–±–æ—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `final_response`: –§—ñ–Ω–∞–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∞–≥–µ–Ω—Ç–∞
- `llm_model`: –ú–æ–¥–µ–ª—å LLM (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

### `create_math_notebook`
–°—Ç–≤–æ—Ä—é—î PDF –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏–π –∑–æ—à–∏—Ç –∑ —Ä–æ–∑–≤'—è–∑–∫–æ–º –∑–∞–¥–∞—á—ñ.

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
- `problem_statement`: –§–æ—Ä–º—É–ª—é–≤–∞–Ω–Ω—è –∑–∞–¥–∞—á—ñ
- `solution_steps`: –ü–æ–∫—Ä–æ–∫–æ–≤–µ —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è (LaTeX)
- `final_answer`: –§—ñ–Ω–∞–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ:

```bash
python test_pdf_generation.py
```

–¢–µ—Å—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:
1. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—é debug PDF
2. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—é math notebook PDF
3. –†–æ–±–æ—Ç—É PDF —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –∞–≥–µ–Ω—Ç–∞

## –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### –®–ª—è—Ö–∏
- `OUTPUT_PDF_DIR`: –î–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è PDF (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: `output_pdfs/`)
- `TYPST_TEMPLATES_DIR`: –î–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è –∑ —à–∞–±–ª–æ–Ω–∞–º–∏ Typst

### –õ–æ–≥—É–≤–∞–Ω–Ω—è
PDF –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É —Å–∏—Å—Ç–µ–º—É –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ–µ–∫—Ç—É. –†—ñ–≤–µ–Ω—å –ª–æ–≥—É–≤–∞–Ω–Ω—è –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –≤ `src/utils/logger_config.py`.

## –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ß–µ—Ä–µ–∑ REPL
```
üë§ –í–∏: –†–æ–∑–≤'—è–∂–∏ —Ä—ñ–≤–Ω—è–Ω–Ω—è x¬≤ - 5x + 6 = 0 —ñ —Å—Ç–≤–æ—Ä–∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏–π –∑–æ—à–∏—Ç

ü§ñ –ê–≥–µ–Ω—Ç: –†–æ–∑–≤'—è–∑—É—é –∫–≤–∞–¥—Ä–∞—Ç–Ω–µ —Ä—ñ–≤–Ω—è–Ω–Ω—è...
[–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î calculator –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω—å]
[–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î create_math_notebook –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è PDF]

‚úÖ PDF –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–æ–≥–æ –∑–æ—à–∏—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–æ: output_pdfs/math_notebook_abc123.pdf
```

### –ü—Ä–æ–≥—Ä–∞–º–Ω–æ
```python
from src.agent.tools.pdf_tools import create_math_notebook

result = create_math_notebook(
    problem_statement="–†–æ–∑–≤'—è–∑–∞—Ç–∏ x¬≤ - 5x + 6 = 0",
    solution_steps=r"""
    –ö–≤–∞–¥—Ä–∞—Ç–Ω–µ —Ä—ñ–≤–Ω—è–Ω–Ω—è: $x^2 - 5x + 6 = 0$
    
    –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ñ–æ—Ä–º—É–ª—É: $x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}$
    
    $a = 1, b = -5, c = 6$
    
    $D = (-5)^2 - 4 \cdot 1 \cdot 6 = 25 - 24 = 1$
    
    $x_1 = \frac{5 + 1}{2} = 3$
    $x_2 = \frac{5 - 1}{2} = 2$
    """,
    final_answer="x‚ÇÅ = 3, x‚ÇÇ = 2"
)
print(result)
```

## –ü–æ–º–∏–ª–∫–∏ —Ç–∞ –í–∏—Ä—ñ—à–µ–Ω–Ω—è

### Typst –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ
```
FileNotFoundError: Typst –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ
```
**–†—ñ—à–µ–Ω–Ω—è:** –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å Typst –∑–≥—ñ–¥–Ω–æ –∑ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏ –≤–∏—â–µ.

### –ü–æ–º–∏–ª–∫–∞ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó —à–∞–±–ª–æ–Ω—É
```
CalledProcessError: –ü–æ–º–∏–ª–∫–∞ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó Typst
```
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —à–∞–±–ª–æ–Ω—É Typst —Ç–∞ –≤–∞–ª—ñ–¥–Ω—ñ—Å—Ç—å JSON –¥–∞–Ω–∏—Ö.

### –í—ñ–¥—Å—É—Ç–Ω—ñ —à–∞–±–ª–æ–Ω–∏
–ë–∞–∑–æ–≤—ñ —à–∞–±–ª–æ–Ω–∏ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É. –Ø–∫—â–æ –≤–∏–Ω–∏–∫–∞—é—Ç—å –ø—Ä–æ–±–ª–µ–º–∏, –≤–∏–¥–∞–ª—ñ—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é `templates/typst/` - –≤–æ–Ω–∞ –±—É–¥–µ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–∞.

## –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö —à–∞–±–ª–æ–Ω—ñ–≤
1. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π `.typ` —Ñ–∞–π–ª –≤ `templates/typst/`
2. –î–æ–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—é –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –≤ `pdf_generator.py`
3. –°—Ç–≤–æ—Ä—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤ `pdf_tools.py`

### –ö–∞—Å—Ç–æ–º—ñ–∑–∞—Ü—ñ—è —ñ—Å–Ω—É—é—á–∏—Ö —à–∞–±–ª–æ–Ω—ñ–≤
–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ —Ñ–∞–π–ª–∏ –≤ `templates/typst/` –¥–ª—è –∑–º—ñ–Ω–∏ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ –≤–∏–≥–ª—è–¥—É PDF –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤. 